import{j as e}from"./jsx-runtime.wYd2HwNx.js";import{r as n}from"./index.KqYmeiyw.js";const E=()=>{const[h,b]=n.useState(null),[a,f]=n.useState("inactive"),[i,u]=n.useState(""),[v,y]=n.useState(!0),[j,s]=n.useState(!1),[C,o]=n.useState(""),[x,c]=n.useState(!1),[l,m]=n.useState(""),[N,p]=n.useState(0);n.useEffect(()=>{(async()=>{try{const d=await fetch("/api/announcements");if(d.ok){const r=(await d.json())[0];r&&(b(r._id),f(r.status),u(r.status==="active"?r.content:""))}else console.error("Failed to fetch announcements")}catch(d){console.error("Error fetching announcements:",d)}finally{y(!1)}})()},[]);const g=t=>{f(t),t==="inactive"&&(u(""),p(0))},w=async()=>{if(!h){o("Announcement ID is missing."),s(!0),c(!1);return}if(a==="active"&&(i.length<60||i.length>105)){o("Content must be between 60 and 105 characters."),s(!0),c(!1);return}try{(await fetch("/api/announcements",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:h,content:a==="active"?i:"",status:a})})).ok?(o("Announcement updated successfully!"),s(!0),c(!1)):(o("Failed to update announcement."),s(!0),c(!1))}catch(t){console.error("Error updating announcement:",t),o("An error occurred. Please try again."),s(!0),c(!1)}},S=()=>{s(!0),o("Type 'yes' to confirm the updated Announcements Banner."),c(!0)},A=t=>{m(t.target.value)},k=()=>{l.toLowerCase()==="yes"&&(w(),s(!1),m(""))};return v?e.jsx("p",{className:"ml-4 pb-10 text-2xl",children:"Loading announcements editor..."}):e.jsxs("div",{className:"mx-4 pt-4 pb-16",children:[e.jsx("h1",{className:"font-bold text-2xl pb-2",children:"Announcements Banner"}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 text-xl",children:[e.jsxs("label",{className:"mr-4",children:[e.jsx("input",{type:"radio",name:"status",value:"inactive",checked:a==="inactive",onChange:()=>g("inactive")})," ","Off"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"status",value:"active",checked:a==="active",onChange:()=>g("active")})," ","On"]})]}),e.jsxs("div",{children:[e.jsx("textarea",{id:"announcementInput",placeholder:"Enter text here; Minimum of 60 characters, Maximum of 105.",disabled:a==="inactive",value:i,onChange:t=>{u(t.target.value),p(t.target.value.length)},minLength:60,maxLength:105,className:"p-1 w-4/5 lg:w-full h-24 border rounded-md"}),e.jsxs("div",{className:"text-sm",children:["Characters: ",N,"/105"]})]})]}),e.jsx("button",{onClick:S,className:"mt-2 px-4 py-2 bg-[#7F0201] hover:bg-[#A52A2A] text-white font-bold rounded-3xl",children:"Save"}),j&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-gray-800 bg-opacity-75",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-2/3 md:w-1/3",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:x?"Confirm Submission":"Message"}),e.jsx("p",{className:"mb-4",children:C}),x?e.jsxs("div",{children:[e.jsx("input",{type:"text",value:l,onChange:A,placeholder:"Type 'yes' to confirm",className:"w-full p-2 border rounded mb-4"}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{onClick:k,disabled:l.toLowerCase()!=="yes",className:`px-4 py-2 ${l.toLowerCase()==="yes"?"bg-[#7F0201] text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"} rounded-3xl mr-2`,children:"Confirm"}),e.jsx("button",{onClick:()=>{s(!1),m("")},className:"px-4 py-2 bg-gray-300 text-black rounded-3xl",children:"Cancel"})]})]}):e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 bg-gray-300 text-black rounded-3xl",children:"Close"})})]})})]})};export{E as default};
