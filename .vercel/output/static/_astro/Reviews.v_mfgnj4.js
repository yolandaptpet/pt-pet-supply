import{j as e}from"./jsx-runtime.wYd2HwNx.js";import{r}from"./index.KqYmeiyw.js";function T(t,n,a){var g=this,i=r.useRef(null),d=r.useRef(0),s=r.useRef(null),o=r.useRef([]),f=r.useRef(),x=r.useRef(),b=r.useRef(t),p=r.useRef(!0);b.current=t;var w=typeof window<"u",c=!n&&n!==0&&w;if(typeof t!="function")throw new TypeError("Expected a function");n=+n||0;var j=!!(a=a||{}).leading,v=!("trailing"in a)||!!a.trailing,h="maxWait"in a,y="debounceOnServer"in a&&!!a.debounceOnServer,m=h?Math.max(+a.maxWait||0,n):null;r.useEffect(function(){return p.current=!0,function(){p.current=!1}},[]);var E=r.useMemo(function(){var S=function(l){var u=o.current,F=f.current;return o.current=f.current=null,d.current=l,x.current=b.current.apply(F,u)},N=function(l,u){c&&cancelAnimationFrame(s.current),s.current=c?requestAnimationFrame(l):setTimeout(l,u)},k=function(l){if(!p.current)return!1;var u=l-i.current;return!i.current||u>=n||u<0||h&&l-d.current>=m},C=function(l){return s.current=null,v&&o.current?S(l):(o.current=f.current=null,x.current)},A=function l(){var u=Date.now();if(k(u))return C(u);if(p.current){var F=n-(u-i.current),M=h?Math.min(F,m-(u-d.current)):F;N(l,M)}},R=function(){if(w||y){var l=Date.now(),u=k(l);if(o.current=[].slice.call(arguments),f.current=g,i.current=l,u){if(!s.current&&p.current)return d.current=i.current,N(A,n),j?S(i.current):x.current;if(h)return N(A,n),S(i.current)}return s.current||N(A,n),x.current}};return R.cancel=function(){s.current&&(c?cancelAnimationFrame(s.current):clearTimeout(s.current)),d.current=0,o.current=i.current=f.current=s.current=null},R.isPending=function(){return!!s.current},R.flush=function(){return s.current?C(Date.now()):x.current},R},[j,h,n,m,v,c,w,y]);return E}function D(t,n){return t===n}function B(t,n,a){var g=D,i=r.useRef(t),d=r.useState({})[1],s=T(r.useCallback(function(f){i.current=f,d({})},[d]),n,a),o=r.useRef(t);return g(o.current,t)||(s(t),o.current=t),[i.current,s]}const O=({review:t,onClose:n})=>(r.useEffect(()=>{const a=document.querySelector("#modal");a&&document.startViewTransition&&document.startViewTransition(()=>{a.animate([{transform:"scale(0.9)",opacity:0},{transform:"scale(1)",opacity:1}],{duration:300,easing:"ease-in-out"})})},[]),e.jsx("div",{id:"modal",className:"fixed inset-0 bg-gray-500 bg-opacity-50 z-50 flex justify-center items-center","aria-modal":"true",role:"dialog",children:e.jsx("div",{className:"relative z-60 w-[320px] min-[500px]:w-[420px] md:w-[510px] lg:w-[510px] h-auto py-10 flex flex-col rounded-3xl bg-gradient-to-br from-[#f9dcb1] to-[#ffc76dd0] drop-shadow-2xl",style:{backdropFilter:"blur(35px)"},children:e.jsxs("div",{className:"flex flex-col items-center px-6 max-[500px]:mt-6",children:[e.jsxs("div",{className:"bg-[#ffffffc9] px-3.5 pt-2 pb-1 mb-3 w-fit text-2xl rounded-xl drop-shadow-md",children:[e.jsxs("span",{className:"font-semibold tracking-tighter",children:[t.author.split(" ")[0],"  ",t.author.split(" ")[1]?.[0].toUpperCase(),"."]}),e.jsx("span",{className:"ml-2 text-yellow-500",children:"★".repeat(t.rating)})]}),e.jsx("p",{className:"text-[#452B1F] mt-1.5 mx-4 text-lg",children:t.text}),e.jsx("button",{onClick:n,className:"absolute top-4 left-4 p-1 bg-[#7F0201] hover:bg-[#A52A2A] text-white font-bold rounded-xl","aria-label":"Close modal",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})})})]})},t.id)})),L=({businessId:t,apiKey:n})=>{const[a,g]=r.useState([]),[i,d]=r.useState(!0),[s,o]=r.useState(null),[f,x]=r.useState(null),[b]=B(t,500);r.useEffect(()=>{(async()=>{if(typeof window>"u"||!window.google){o("Google Maps API not loaded"),d(!1);return}try{new google.maps.places.PlacesService(document.createElement("div")).getDetails({placeId:t,fields:["reviews"]},(v,h)=>{if(h===google.maps.places.PlacesServiceStatus.OK&&v?.reviews){const y=v.reviews.filter(m=>(m.rating??0)>=4).map(m=>({id:m.time.toString(),author:m.author_name,rating:m.rating??0,text:m.text??""})).slice(0,3);g(y)}else o("No reviews available");d(!1)})}catch{o("Failed to fetch reviews"),d(!1)}})()},[t,n,b]);const p=c=>{document.body.style.overflow="hidden",x(c)},w=()=>{document.startViewTransition?document.startViewTransition(()=>{x(null)}):x(null),document.body.style.overflow="auto"};return i?e.jsx("p",{children:"Loading..."}):s?e.jsx("p",{children:s}):e.jsxs(e.Fragment,{children:[f&&e.jsx(O,{review:f,onClose:w}),e.jsx("section",{className:"space-y-4 lg:space-y-0 lg:space-x-6 lg:flex mb-8",children:a.map(c=>e.jsxs("div",{onClick:()=>p(c),className:"relative w-[300px] min-[500px]:w-[348px] md:w-[445px] lg:w-[285px] xl:w-[320px] h-[150px] flex-grow flex items-center justify-between rounded-3xl bg-gradient-to-br from-[#f9dcb157] to-[#ffc76d81] drop-shadow-2xl cursor-pointer",children:[e.jsx("div",{className:"absolute top-5 -left-2",children:e.jsx("img",{src:"src/assets/review-icon.svg",alt:"Review author photo",className:"w-[55px] h-auto rounded-2xl p-1.5 bg-gradient-to-tl from-[#7F0201] via-[#A52A2A] to-[#FFC66D]"})}),e.jsxs("div",{className:"ml-12 px-4",children:[e.jsxs("div",{className:"flex items-center text-xl",children:[e.jsxs("span",{className:"font-semibold tracking-tighter",children:[c.author.split(" ")[0],"  ",c.author.split(" ")[1]?.[0].toUpperCase(),"."]}),e.jsx("span",{className:"ml-2 text-yellow-500",children:"★".repeat(c.rating)})]}),e.jsx("p",{className:"text-[#452B1F] max-h-16 mt-1.5 tracking-tighter line-clamp-3",children:c.text})]})]},c.id))})]})};export{L as default};
