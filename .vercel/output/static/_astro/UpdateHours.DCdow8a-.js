import{j as e}from"./jsx-runtime.wYd2HwNx.js";import{r as t}from"./index.KqYmeiyw.js";const D=({storeHours:p})=>{const[c,C]=t.useState(null),[l,m]=t.useState("normal"),[g,H]=t.useState(),[b,w]=t.useState(),[S,I]=t.useState(!0),[n,h]=t.useState(p),[k,r]=t.useState(!1),[A,o]=t.useState(""),[j,d]=t.useState(!1),[u,f]=t.useState("");t.useEffect(()=>{(async()=>{try{const a=await fetch("/api/store-info");if(!a.ok)throw new Error("Failed to fetch active hours");const v=(await a.json())[0],i=v.info;i&&(C(v._id),H(i.storeHours.normal),w(i.storeHours.adjusted),i.storeHours.activeHours==="normal"?m("normal"):i.storeHours.activeHours==="adjusted"&&m("adjusted"))}catch{o("Error fetching active hours."),r(!0)}finally{I(!1)}})()},[]);const E=async()=>{if(console.log("ID:",c),console.log("Editable Hours:",n),!(!c||!n)){if(!c){o("Store Info ID is missing."),r(!0),d(!1);return}try{(await fetch("/api/store-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c,activeHours:l,adjusted:n})})).ok?(o("Store hours updated successfully!"),r(!0),d(!1)):(o("Failed to update store hours."),r(!0),d(!1))}catch(s){console.error("Error updating store hours:",s),o("An error occurred. Please try again."),r(!0),d(!1)}}},T=()=>{r(!0),o("Type 'yes' to confirm the updated Hours of Operation."),d(!0)},y=(s,a)=>{h(x=>({...x,[s]:{...x[s],...a}}))},N=s=>{m(s.target.value),s.target.value==="normal"&&g!==void 0?h(g):s.target.value==="adjusted"&&b!==void 0&&h(b)},O=s=>{f(s.target.value)},M=()=>{u.toLowerCase()==="yes"&&(E(),r(!1),f(""))};return S?e.jsx("p",{className:"ml-4 pb-10 text-2xl",children:"Loading store hours editor..."}):e.jsxs("div",{className:"mx-4 pb-5",children:[e.jsx("h1",{className:"font-bold text-2xl",children:"Update Hours of Operation"}),e.jsxs("div",{className:"max-w-lg my-5",children:[e.jsxs("div",{className:"mb-4 text-lg",children:[e.jsxs("label",{className:"mr-4",children:[e.jsx("input",{type:"radio",name:"hours-toggle",value:"normal",checked:l==="normal",onChange:N}),"Normal Hours"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"hours-toggle",value:"adjusted",checked:l==="adjusted",onChange:N}),"Adjusted Hours"]})]}),e.jsxs("table",{id:"hours-table",className:"w-full border-collapse text-lg",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border border-gray-300 text-left",children:"Day"}),e.jsx("th",{className:"p-2 border border-gray-300 text-left",children:"Opening Time"}),e.jsx("th",{className:"p-2 border border-gray-300 text-left",children:"Closing Time"})]})}),e.jsx("tbody",{children:Object.entries(p).map(([s])=>e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border border-gray-300",children:s}),e.jsx("td",{className:"p-2 border border-gray-300",children:e.jsx("input",{type:"time",value:n[s].open,className:"w-full p-1 box-border disabled:bg-gray-200 disabled:cursor-not-allowed",disabled:l==="normal",onChange:a=>y(s,{open:a.target.value})})}),e.jsx("td",{className:"p-2 border border-gray-300",children:e.jsx("input",{type:"time",value:n[s].close,className:"w-full p-1 box-border disabled:bg-gray-200 disabled:cursor-not-allowed",disabled:l==="normal",onChange:a=>y(s,{close:a.target.value})})})]},s))})]}),e.jsx("button",{onClick:T,className:"mt-4 px-4 py-2 bg-[#7F0201] hover:bg-[#A52A2A] text-white font-bold rounded-3xl",children:"Save"}),k&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-gray-800 bg-opacity-75",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-2/3 md:w-1/3",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:j?"Confirm Submission":"Message"}),e.jsx("p",{className:"mb-4",children:A}),j?e.jsxs("div",{children:[e.jsx("input",{type:"text",value:u,onChange:O,placeholder:"Type 'yes' to confirm",className:"w-full p-2 border rounded mb-4"}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{onClick:M,disabled:u.toLowerCase()!=="yes",className:`px-4 py-2 ${u.toLowerCase()==="yes"?"bg-[#7F0201] text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"} rounded-3xl mr-2`,children:"Confirm"}),e.jsx("button",{onClick:()=>{r(!1),f("")},className:"px-4 py-2 bg-gray-300 text-black rounded-3xl",children:"Cancel"})]})]}):e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 bg-gray-300 text-black rounded-3xl",children:"Close"})})]})})]})]})};export{D as default};
